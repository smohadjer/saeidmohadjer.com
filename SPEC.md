# Example URLs
- https://saeidmohadjer.com/blog
- https://saeidmohadjer.com/blog?response=json
- https://saeidmohadjer.com/blog/tag/css

  
# Request-response life-cycle

1. Browser sends a get request for `/blog` to the server.
1. A rewrite rule in `/vercel.json` redirects request to `/api/blog` endpoint before request reaches the server (For more info see [Rewrites on Vercel](https://vercel.com/docs/edge-network/rewrites)). The `/api/blog` endpoint is a [serverless Node.js function](https://vercel.com/docs/functions/runtimes/node-js) hosted on Vercel.
2. The endpoint connects to a MongoDB database and fetches all the blog posts.
1. If request has a query `response=json` the endpoint returns all blog posts as json in response, otherwise it continues with the next steps. 
1. The endpoint script reads file `/public/blog-template.html` from disc. This file which contains layout for the blog page doesn't exist in repository and is generated by frontend build via GitHub Actions during deployment.
2. The script converts blog posts data into HTML using [Handlebars](https://www.npmjs.com/package/handlebars) and [Marked](https://www.npmjs.com/package/marked) libraries and a template file (/templates/listing.hbs).
3. The endpoint inserts the HTML into blog layout file using regex and returns the result in response as text/html.
